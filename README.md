# HisVis2

## Project Description
Work for Part 2 of HisVis Project. In this project, we developed a scene detection dataset and trained models for predicting the labels. 
The input data for this project are press photographs from the _De Boer_ collection. 

This project includes software to:
    - automatically resize and crop the images
    - automatically rotate them to the correct orientation
    - training a rotation model
    - updating a pre-trained Places-365 model to our data
    - training a classifier on top of a CLIP model 
    - making predictions for the scene categories
    - making predictions for the categories (indoor / outdoor)
    - preparing output generated by the annotation software (_VeleHanden)
    - analyzing the annotations
    - checking whether the algorithm can also be applied to uncropped images

## Prerequisites

See `requirements.txt` to set up a Conda environment. 
`conda create --name <envname> --file requirements.txt`


## Contributing
Issue Tracker: https://github.com/melvinwevers/HisVis2/issues


## License

## Citation


## Contact
Dr. Melvin (Wevers melvin.wevers@uva.nl)


## Folder Structure

### Data

#### Intermediary
`annotations_step1 to 3` - contains database exports provided by Picturae [TO BE REMOVED]

`metadata-with-connected-files-2022-05-23-csv.csv` metadata linked to images is used for sampling images for step 3. 

#### Processed

##### Annotations
`annotation_data_step1.csv` = processed database export
`annotation_data_step21.csv` = processed database export
`annotation_data_step3.csv` = processed database export

##### Training Data
`all_labels.txt` - list of all labels used
`no_desc_step2.csv` - csv containing files that were labelled as `no description` after annotation step 2
`no_desc_step3.csv` - csv containing files that were labelled as `no description` after annotation step 3


#### Raw

#### Test
contains test files

`indoor_outdoor_sample_images.csv` - csv with predictions of indoor outdoor images for annotation [TO BE REMOVED]
`metadata-with-connected-files.csv` - csv with links to metadata kept in DeBoer logs. This file was used to find samples of images for specific categories
`samples_prediction_test.csv` - csv with files used to test prediction on cropped and uncropped images. 

### Models


### Notebooks


### Output

### SRC

- `find_correct_rotation.py` - Python script to rotate images until they are correctly oriented. This makes use of the `rotation.pkl` model. This has been trained using the notebook `train_model_rotation.ipynb`



## Training the model 

We can train the model using a Jupyter Notebook or a Python Script that can be called using the `run.sh` bash script. 

